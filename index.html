<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</title>

<!-- ‡∏ü‡πâ‡∏≠‡∏ô‡∏ï‡πå Sukumvit: ‡πÉ‡∏ä‡πâ Google Fonts ‡πÅ‡∏ó‡∏ô -->
<link href="https://fonts.googleapis.com/css2?family=Kanit&display=swap" rel="stylesheet" />

<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
  /* ‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å */
  :root {
    --color-primary: #0f1440;
    --color-secondary: #e46700;
    --color-accent: #ebcb1e;
  }

  body {
    margin: 0; padding: 0;
    font-family: 'Kanit', sans-serif;
    background-color: #f5f5f5;
    color: var(--color-primary);
  }

  header {
    background-color: var(--color-primary);
    color: white;
    display: flex;
    align-items: center;
    padding: 10px 20px;
  }

  header img.logo {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 15px;
  }

  header h1 {
    font-weight: 700;
    font-size: 1.5rem;
  }

  nav {
    background-color: var(--color-primary);
    display: flex;
    justify-content: space-around;
  }

  nav button {
    background: none;
    border: none;
    color: white;
    padding: 15px 20px;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    transition: background-color 0.3s ease;
  }

  nav button:hover, nav button.active {
    background-color: var(--color-secondary);
  }

  main {
    padding: 20px;
    max-width: 900px;
    margin: auto;
    background-color: white;
    box-shadow: 0 0 10px rgb(0 0 0 / 0.1);
    margin-top: 20px;
    border-radius: 8px;
  }

  h2 {
    color: var(--color-primary);
    margin-bottom: 15px;
  }

  label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
  }

  input[type="text"], input[type="date"], input[type="time"], select, textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-size: 1rem;
  }

  textarea {
    resize: vertical;
  }

  button.save-btn {
    margin-top: 15px;
    background-color: var(--color-secondary);
    border: none;
    color: white;
    padding: 10px 20px;
    font-weight: 700;
    border-radius: 5px;
    cursor: pointer;
  }

  button.save-btn:hover {
    background-color: var(--color-accent);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }

  th, td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: left;
  }

  th {
    background-color: var(--color-primary);
    color: white;
  }

  /* ‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß */
  .speed-‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î { color: white; background-color: red; padding: 2px 6px; border-radius: 3px; }
  .speed-‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å { color: black; background-color: yellow; padding: 2px 6px; border-radius: 3px; }
  .speed-‡∏î‡πà‡∏ß‡∏ô { color: white; background-color: blue; padding: 2px 6px; border-radius: 3px; }
  .speed-‡∏õ‡∏Å‡∏ï‡∏¥ { color: white; background-color: green; padding: 2px 6px; border-radius: 3px; }

  /* ‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö */
  .secret-‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î { color: black; background-color: yellow; padding: 2px 6px; border-radius: 3px; }
  .secret-‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å { color: white; background-color: red; padding: 2px 6px; border-radius: 3px; }
  .secret-‡∏•‡∏±‡∏ö { color: white; background-color: blue; padding: 2px 6px; border-radius: 3px; }

</style>
</head>
<body>

<header>
  <img src="https://img2.pic.in.th/pic/Logo-Ubnpeofc3812ce8a9f1a77.jpg" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ ‡∏®‡∏ò‡∏à.‡∏≠‡∏∏‡∏ö‡∏•" class="logo" />
  <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì ‡∏®‡∏ò‡∏à.‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</h1>
</header>

<nav>
  <button id="menu-dashboard" class="active">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
  <button id="menu-register">üîº ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö</button>
  <button id="menu-staff">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</button>
  <button id="menu-report">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
</nav>

<main id="content">

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ Dashboard -->
  <section id="dashboard" style="display: block;">
    <h2>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
    <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <span id="countToday">0</span> ‡πÄ‡∏•‡πà‡∏°</div>
    <h3>‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
    <table id="latestBooksTable">
      <thead>
        <tr>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
          <th>‡πÄ‡∏•‡∏Ç‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏≤‡∏á</th>
          <th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡πÅ‡∏ñ‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
      </tbody>
    </table>
  </section>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö -->
  <section id="register" style="display:none;">
    <h2>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö</h2>
    <form id="bookForm">
      <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
      <input type="date" id="bookDate" required />
      <label>‡πÄ‡∏ß‡∏•‡∏≤</label>
      <input type="time" id="bookTime" required />

      <label>‡πÄ‡∏•‡∏Ç‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏≤‡∏á</label>
      <input type="text" id="centralDocNo" required />

      <label>‡πÄ‡∏•‡∏Ç‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
      <input type="text" id="groupDocNo" required />

      <label>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</label>
      <select id="speedLevel" required>
        <option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å--</option>
        <option value="‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" style="color:white; background-color:red;">‡∏î‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
        <option value="‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å" style="color:black; background-color:yellow;">‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å</option>
        <option value="‡∏î‡πà‡∏ß‡∏ô" style="color:white; background-color:blue;">‡∏î‡πà‡∏ß‡∏ô</option>
        <option value="‡∏õ‡∏Å‡∏ï‡∏¥" style="color:white; background-color:green;">‡∏õ‡∏Å‡∏ï‡∏¥</option>
      </select>

      <label>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</label>
      <select id="secretLevel" required>
        <option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å--</option>
        <option value="‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" style="color:black; background-color:yellow;">‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
        <option value="‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å" style="color:white; background-color:red;">‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Å</option>
        <option value="‡∏•‡∏±‡∏ö" style="color:white; background-color:blue;">‡∏•‡∏±‡∏ö</option>
      </select>

      <label>‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ - ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà - ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
      <input type="text" id="sourceDepartment" list="departmentList" />

      <datalist id="departmentList">
        <!-- ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô localStorage ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
      </datalist>

      <label>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
      <input type="text" id="forWhom" />

      <label>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
      <select id="staffSelect" required>
        <option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà--</option>
        <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å localStorage -->
      </select>

      <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
      <textarea id="remark" rows="3"></textarea>

      <button type="submit" class="save-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</button>
    </form>

    <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</h3>
    <table id="bookTable">
      <thead>
        <tr>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö</th>
          <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
          <th>‡πÄ‡∏•‡∏Ç‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏≤‡∏á</th>
          <th>‡πÄ‡∏•‡∏Ç‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì‡∏Å‡∏•‡∏∏‡πà‡∏°</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</th>
          <th>‡∏ä‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö</th>
          <th>‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</th>
          <th>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
          <th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
        </tr>
      </thead>
      <tbody>
        <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ JS -->
      </tbody>
    </table>
  </section>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà -->
  <section id="staff" style="display:none;">
    <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</h2>
    <form id="staffForm">
      <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" id="staffName" required />
      <label>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
      <input type="text" id="staffPosition" required />
      <button type="submit" class="save-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</button>
    </form>

    <h3>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</h3>
    <table id="staffTable">
      <thead>
        <tr><th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th><th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th></tr>
      </thead>
      <tbody>
        <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ JS -->
      </tbody>
    </table>
  </section>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô -->
  <section id="report" style="display:none;">
    <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
    <div id="reportContent">
      <p>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠‡πÑ‡∏õ</p>
    </div>
  </section>

</main>

<script>
  // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤
  const pages = ['dashboard', 'register', 'staff', 'report'];
  const menuButtons = {
    dashboard: document.getElementById('menu-dashboard'),
    register: document.getElementById('menu-register'),
    staff: document.getElementById('menu-staff'),
    report: document.getElementById('menu-report'),
  };

  function showPage(page) {
    pages.forEach(p => {
      document.getElementById(p).style.display = p === page ? 'block' : 'none';
      menuButtons[p].classList.toggle('active', p === page);
    });
  }

  Object.keys(menuButtons).forEach(key => {
    menuButtons[key].addEventListener('click', () => showPage(key));
  });

  showPage('dashboard');

  // Local Storage keys
  const LS_BOOKS = 'ubn_books';
  const LS_STAFF = 'ubn_staff';
  const LS_DEPARTMENTS = 'ubn_departments';

  // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
  function loadBooks() {
    const data = localStorage.getItem(LS_BOOKS);
    return data ? JSON.parse(data) : [];
  }
  function saveBooks(data) {
    localStorage.setItem(LS_BOOKS, JSON.stringify(data));
  }

  function loadStaff() {
    const data = localStorage.getItem(LS_STAFF);
    return data ? JSON.parse(data) : [];
  }
  function saveStaff(data) {
    localStorage.setItem(LS_STAFF, JSON.stringify(data));
  }

  function loadDepartments() {
    const data = localStorage.getItem(LS_DEPARTMENTS);
    return data ? JSON.parse(data) : [];
  }
  function saveDepartments(data) {
    localStorage.setItem(LS_DEPARTMENTS, JSON.stringify(data));
  }

  // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö
  function renderBooksTable() {
    const books = loadBooks();
    const tbody = document.querySelector('#bookTable tbody');
    tbody.innerHTML = '';
    books.forEach(b => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${b.bookDate}</td>
        <td>${b.bookTime}</td>
        <td>${b.centralDocNo}</td>
        <td>${b.groupDocNo}</td>
        <td><span class="speed-${b.speedLevel}">${b.speedLevel}</span></td>
        <td><span class="secret-${b.secretLevel}">${b.secretLevel}</span></td>
        <td>${b.sourceDepartment}</td>
        <td>${b.forWhom}</td>
        <td>${b.staffName}</td>
        <td>${b.remark}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
  function renderStaffTable() {
    const staffList = loadStaff();
    const tbody = document.querySelector('#staffTable tbody');
    tbody.innerHTML = '';
    staffList.forEach(s => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${s.name}</td><td>${s.position}</td>`;
      tbody.appendChild(tr);
    });

    // ‡πÄ‡∏ï‡∏¥‡∏° dropdown ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö
    const staffSelect = document.getElementById('staffSelect');
    staffSelect.innerHTML = '<option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà--</option>';
    staffList.forEach(s => {
      const opt = document.createElement('option');
      opt.value = s.name;
      opt.textContent = `${s.name} (${s.position})`;
      staffSelect.appendChild(opt);
    });
  }

  // ‡πÄ‡∏ï‡∏¥‡∏° datalist ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
  function renderDepartmentList() {
    const departments = loadDepartments();
    const datalist = document.getElementById('departmentList');
    datalist.innerHTML = '';
    departments.forEach(dep => {
      const opt = document.createElement('option');
      opt.value = dep;
      datalist.appendChild(opt);
    });
  }

  // ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö submit
  document.getElementById('bookForm').addEventListener('submit', function(e){
    e.preventDefault();
    const bookDate = this.bookDate.value;
    const bookTime = this.bookTime.value;
    const centralDocNo = this.centralDocNo.value.trim();
    const groupDocNo = this.groupDocNo.value.trim();
    const speedLevel = this.speedLevel.value;
    const secretLevel = this.secretLevel.value;
    const sourceDepartment = this.sourceDepartment.value.trim();
    const forWhom = this.forWhom.value.trim();
    const staffName = this.staffSelect.value;
    const remark = this.remark.value.trim();

    if (!bookDate || !bookTime || !centralDocNo || !groupDocNo || !speedLevel || !secretLevel || !staffName) {
      Swal.fire('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô');
      return;
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
    let departments = loadDepartments();
    if (sourceDepartment && !departments.includes(sourceDepartment)) {
      departments.push(sourceDepartment);
      saveDepartments(departments);
      renderDepartmentList();
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
    let books = loadBooks();
    books.push({
      bookDate, bookTime, centralDocNo, groupDocNo,
      speedLevel, secretLevel, sourceDepartment, forWhom, staffName, remark
    });
    saveBooks(books);

    Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');

    this.reset();
    renderBooksTable();
    updateDashboard();
  });

  // ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà submit
  document.getElementById('staffForm').addEventListener('submit', function(e){
    e.preventDefault();
    const name = this.staffName.value.trim();
    const position = this.staffPosition.value.trim();

    if (!name || !position) {
      Swal.fire('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á');
      return;
    }

    let staffList = loadStaff();
    staffList.push({name, position});
    saveStaff(staffList);

    Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');

    this.reset();
    renderStaffTable();
  });

  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dashboard
  function updateDashboard() {
    const books = loadBooks();
    const todayStr = new Date().toISOString().slice(0,10);
    const todayBooks = books.filter(b => b.bookDate === todayStr);
    document.getElementById('countToday').textContent = todayBooks.length;

    // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    const latestTableBody = document.querySelector('#latestBooksTable tbody');
    latestTableBody.innerHTML = '';
    const sortedBooks = books.slice().sort((a,b) => {
      // ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà+‡πÄ‡∏ß‡∏•‡∏≤ ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô
      const dtA = new Date(a.bookDate + 'T' + a.bookTime);
      const dtB = new Date(b.bookDate + 'T' + b.bookTime);
      return dtB - dtA;
    });
    sortedBooks.slice(0,5).forEach(b => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${b.bookDate}</td>
        <td>${b.centralDocNo}</td>
        <td>${b.staffName}</td>
        <td><span class="speed-${b.speedLevel}">${b.speedLevel}</span></td>
        <td><span class="secret-${b.secretLevel}">${b.secretLevel}</span></td>
      `;
      latestTableBody.appendChild(tr);
    });
  }

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  renderBooksTable();
  renderStaffTable();
  renderDepartmentList();
  updateDashboard();
</script>

</body>
</html>
